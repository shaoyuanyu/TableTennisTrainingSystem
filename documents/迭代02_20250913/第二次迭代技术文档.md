# ä¹’ä¹“çƒåŸ¹è®­ç®¡ç†ç³»ç»Ÿ - ç¬¬äºŒæ¬¡è¿­ä»£æŠ€æœ¯æ–‡æ¡£

## æŠ€æœ¯æ¶æ„æ¦‚è§ˆ

### æ•´ä½“æ¶æ„è®¾è®¡

ç¬¬äºŒæ¬¡è¿­ä»£åœ¨ç¬¬ä¸€æ¬¡çš„åŸºç¡€ä¸Šè¿›è¡Œäº†é‡å¤§å‡çº§ï¼Œå½¢æˆäº†æ›´åŠ æˆç†Ÿå’Œå®Œå–„çš„æŠ€æœ¯æ¶æ„ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å‰ç«¯ (Vue 3)   â”‚    â”‚  åç«¯ (Ktor)    â”‚    â”‚  æ•°æ®åº“ (MySQL)  â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ - è®¾è®¡ç³»ç»Ÿ      â”‚â—„â”€â”€â–ºâ”‚ - RESTful API   â”‚â—„â”€â”€â–ºâ”‚ - ç”¨æˆ·ç®¡ç†      â”‚
â”‚ - æƒé™ç®¡ç†      â”‚    â”‚ - æ¶ˆæ¯ç³»ç»Ÿ      â”‚    â”‚ - æ¶ˆæ¯ç³»ç»Ÿ      â”‚
â”‚ - æ¶ˆæ¯ä¸­å¿ƒ      â”‚    â”‚ - å……å€¼ç³»ç»Ÿ      â”‚    â”‚ - å……å€¼è®°å½•      â”‚
â”‚ - ç¯å¢ƒé…ç½®      â”‚    â”‚ - æ ¡åŒºç®¡ç†      â”‚    â”‚ - æ ¡åŒºç®¡ç†      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å‰ç«¯æŠ€æœ¯å®ç°

### æŠ€æœ¯æ ˆå‡çº§

| æŠ€æœ¯ç»„ä»¶ | ç‰ˆæœ¬ | æ–°å¢åŠŸèƒ½ |
|---------|------|----------|
| Vue | 3.5.18 | è®¾è®¡ç³»ç»Ÿé›†æˆ |
| Element Plus | 2.11.1 | ç»„ä»¶å®šåˆ¶åŒ– |
| Vue Router | 4.5.1 | æƒé™è·¯ç”±å®ˆå« |
| Pinia | 3.0.3 | æ¶ˆæ¯çŠ¶æ€ç®¡ç† |
| Vite | 7.0.6 | ç¯å¢ƒå˜é‡ç®¡ç† |

### è®¾è®¡ç³»ç»Ÿå®ç°

#### 1. Glassmorphism æ ¸å¿ƒæ ·å¼

```css
/* æ ¸å¿ƒè®¾è®¡å˜é‡ */
:root {
  /* é€æ˜åº¦ç³»ç»Ÿ */
  --white-alpha-10: rgba(255, 255, 255, 0.1);
  --white-alpha-15: rgba(255, 255, 255, 0.15);
  --white-alpha-20: rgba(255, 255, 255, 0.2);
  --white-alpha-30: rgba(255, 255, 255, 0.3);
  
  /* æ¯›ç»ç’ƒæ•ˆæœ */
  --blur-sm: blur(4px);
  --blur-md: blur(8px);
  --blur-lg: blur(16px);
  --blur-xl: blur(24px);
  
  /* é˜´å½±ç³»ç»Ÿ */
  --shadow-glass: 0 8px 32px rgba(0, 0, 0, 0.12);
  --shadow-elevated: 0 16px 48px rgba(0, 0, 0, 0.2);
}

/* ç»ç’ƒå¡ç‰‡åŸºç¡€æ ·å¼ */
.glass-card {
  background: var(--white-alpha-15);
  backdrop-filter: var(--blur-xl);
  border: 1px solid var(--white-alpha-20);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-glass);
  transition: var(--transition-slow);
}
```

#### 2. ç»„ä»¶åº“ä½“ç³»

**GlassCard ç³»åˆ—ç»„ä»¶**:

```vue
<!-- GlassDisplayCard - å±•ç¤ºå‹å¡ç‰‡ -->
<GlassDisplayCard
  title="ç»„ä»¶æ ‡é¢˜"
  subtitle="å‰¯æ ‡é¢˜"
  icon="ğŸ¯"
  description="ç»„ä»¶æè¿°ä¿¡æ¯"
  type="glass"
  :tags="[{ text: 'æ ‡ç­¾', type: 'primary' }]"
>
  <div>å†…å®¹åŒºåŸŸ</div>
</GlassDisplayCard>

<!-- GlassCardWithHeader - å¸¦å¤´éƒ¨çš„å¡ç‰‡ -->
<GlassCardWithHeader 
  title="å¡ç‰‡æ ‡é¢˜" 
  icon="ğŸ”§" 
  type="primary"
>
  <StatusGrid :items="statusItems" />
</GlassCardWithHeader>
```

**ModernButton ç»„ä»¶**:

```vue
<!-- ç°ä»£åŒ–æŒ‰é’® -->
<ModernButton 
  text="æŒ‰é’®æ–‡å­—" 
  type="primary" 
  size="large"
  :loading="false"
  :disabled="false"
  @click="handleClick"
/>
```

### å‰åç«¯å¯¹æ¥å®ç°

#### 1. ç¯å¢ƒé…ç½®ç³»ç»Ÿ

```javascript
// .env.development
VITE_API_BASE_URL=http://localhost:8080
VITE_ENABLE_DEBUG=true
VITE_LOG_LEVEL=debug

// .env.production  
VITE_API_BASE_URL=https://api.ttts.com
VITE_ENABLE_DEBUG=false
VITE_LOG_LEVEL=error

// ä½¿ç”¨æ–¹å¼
const apiBaseUrl = import.meta.env.VITE_API_BASE_URL
```

#### 2. æƒé™ç®¡ç†ç³»ç»Ÿ

```javascript
// composables/usePermissions.js
export function usePermissions() {
  const userStore = useUserStore()
  
  const canPerformAction = (action) => {
    return hasActionPermission(action, userStore.userRole)
  }
  
  const requireAuth = () => {
    if (!userStore.isLoggedIn) {
      router.push('/login')
      return false
    }
    return true
  }
  
  return {
    canPerformAction,
    requireAuth,
    isSuperAdmin: computed(() => userStore.isSuperAdmin),
    isCampusAdmin: computed(() => userStore.isCampusAdmin),
    isStudent: computed(() => userStore.isStudent),
    isCoach: computed(() => userStore.isCoach)
  }
}
```

#### 3. æ¶ˆæ¯ç³»ç»Ÿå®ç°

```javascript
// stores/messageStore.js
export const useMessageStore = defineStore('messages', () => {
  const messages = ref([])
  const unreadCount = computed(() => 
    messages.value.filter(msg => !msg.read).length
  )
  
  const fetchMessages = async (params = {}) => {
    const res = await apiFetchMessages(params)
    messages.value = res.data || []
  }
  
  const markAsRead = async (id) => {
    await markMessageAsRead(id)
    const message = messages.value.find(msg => msg.id === id)
    if (message) message.read = true
  }
  
  return {
    messages,
    unreadCount,
    fetchMessages,
    markAsRead
  }
})
```

## åç«¯æŠ€æœ¯å®ç°

### æŠ€æœ¯æ ˆæ‰©å±•

| æŠ€æœ¯ç»„ä»¶ | ç‰ˆæœ¬ | æ–°å¢åŠŸèƒ½ |
|---------|------|----------|
| Kotlin | 2.1.10 | ä¸šåŠ¡é€»è¾‘æ‰©å±• |
| Ktor | 3.2.3 | æ¶ˆæ¯ç³»ç»ŸAPI |
| Exposed | 0.56.0 | å……å€¼è®°å½•ç®¡ç† |
| MySQL | 8.0 | æ•°æ®è¡¨æ‰©å±• |

### æ–°å¢æ•°æ®åº“è®¾è®¡

#### 1. æ¶ˆæ¯ç³»ç»Ÿè¡¨ç»“æ„

```sql
-- æ¶ˆæ¯è¡¨
CREATE TABLE message (
    id VARCHAR(36) PRIMARY KEY,
    recipient_id VARCHAR(36) NOT NULL,
    sender_id VARCHAR(36),
    title VARCHAR(255) NOT NULL,
    content TEXT NOT NULL,
    type ENUM('SYSTEM', 'APPOINTMENT', 'EVALUATION', 'USER', 'EVENT', 'REMINDER') NOT NULL,
    is_read BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (recipient_id) REFERENCES user(id),
    FOREIGN KEY (sender_id) REFERENCES user(id)
);
```

#### 2. å……å€¼è®°å½•è¡¨ç»“æ„

```sql
-- å……å€¼è®°å½•è¡¨
CREATE TABLE recharge (
    id VARCHAR(36) PRIMARY KEY,
    user_id VARCHAR(36) NOT NULL,
    amount FLOAT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES user(id)
);
```

### APIæ¥å£è®¾è®¡

#### 1. æ¶ˆæ¯ç³»ç»ŸAPI

```kotlin
// æ¶ˆæ¯è·¯ç”±é…ç½®
fun Application.messageRoutes(messageService: MessageService) {
    routing {
        route("/messages") {
            authenticate("auth-session-all") {
                get { getMessages(messageService) }
                get("/unread-count") { getUnreadCount(messageService) }
                put("/{id}/read") { markMessageAsRead(messageService) }
                put("/read-all") { markAllMessagesAsRead(messageService) }
                delete("/{id}") { deleteMessage(messageService) }
            }
            
            authenticate("auth-session-super-admin") {
                post { sendMessage(messageService) }
            }
        }
    }
}

// è·å–æ¶ˆæ¯åˆ—è¡¨å®ç°
fun Route.getMessages(messageService: MessageService) {
    get {
        val userId = call.sessions.get<UserSession>()?.userId
            ?: throw UnauthorizedException("æœªç™»å½•")
            
        val type = call.request.queryParameters["type"]
        val unreadOnly = call.request.queryParameters["unreadOnly"]?.toBoolean() ?: false
        val page = call.request.queryParameters["page"]?.toIntOrNull() ?: 0
        val size = call.request.queryParameters["size"]?.toIntOrNull() ?: 20
        
        val messages = messageService.getMessages(userId, type, unreadOnly, page, size)
        call.respond(HttpStatusCode.OK, messages)
    }
}
```

#### 2. é’±åŒ…å……å€¼API

```kotlin
// é’±åŒ…è·¯ç”±é…ç½®
fun Application.walletRoutes(walletService: StudentService) {
    routing {
        route("/wallet") {
            authenticate("auth-session-all") {
                get("/balance") { getWalletBalance(walletService) }
                get("/recharge/history") { getRechargeHistory(walletService) }
            }
            
            authenticate("auth-session-student") {
                post("/recharge") { rechargeWallet(walletService) }
            }
            
            authenticate("auth-session-super-admin") {
                get("/recharge/records") { getAllRechargeRecords(walletService) }
                get("/recharge/records/{username}") { getRechargeRecordsByUserId(walletService) }
            }
        }
    }
}

// å……å€¼åŠŸèƒ½å®ç°
fun Route.rechargeWallet(walletService: StudentService) {
    post("/recharge") {
        val userId = call.sessions.get<UserSession>()?.userId
            ?: throw UnauthorizedException("æœªç™»å½•")
            
        val userRole = call.sessions.get<UserSession>()?.userRole
        if (userRole != UserRole.STUDENT) {
            throw BadRequestException("åªæœ‰å­¦ç”Ÿå¯ä»¥è¿›è¡Œå……å€¼")
        }
        
        val rechargeRequest = call.receive<RechargeRequest>()
        val amount = rechargeRequest.amount
        
        // å‚æ•°éªŒè¯
        if (amount <= 0) {
            throw BadRequestException("å……å€¼é‡‘é¢å¿…é¡»å¤§äº0")
        }
        if (amount > 10000) {
            throw BadRequestException("å•æ¬¡å……å€¼é‡‘é¢ä¸èƒ½è¶…è¿‡10000å…ƒ")
        }
        
        // æ‰§è¡Œå……å€¼
        walletService.recharge(userId, amount)
        val newBalance = walletService.queryBalance(userId)
        
        call.respond(HttpStatusCode.OK, mapOf("balance" to newBalance))
    }
}
```

#### 3. æ ¡åŒºç®¡ç†API

```kotlin
// æ ¡åŒºè·¯ç”±é…ç½®
fun Application.campusRoutes(campusService: CampusService) {
    routing {
        route("/campus") {
            authenticate("auth-session-all") {
                get("/list") { getCampusList(campusService) }
            }
            
            authenticate("auth-session-super-admin") {
                post { createCampus(campusService) }
            }
        }
    }
}
```

### ä¸šåŠ¡é€»è¾‘å±‚å®ç°

#### 1. æ¶ˆæ¯æœåŠ¡

```kotlin
class MessageService(private val database: Database) {
    
    fun getMessages(
        userId: String, 
        type: String?, 
        unreadOnly: Boolean, 
        page: Int, 
        size: Int
    ): MessageListResponse = transaction(database) {
        
        var query = MessageEntity.find { MessageTable.recipientId eq userId }
        
        // ç±»å‹è¿‡æ»¤
        if (type != null) {
            query = query.andWhere { MessageTable.type eq MessageType.valueOf(type) }
        }
        
        // æœªè¯»è¿‡æ»¤
        if (unreadOnly) {
            query = query.andWhere { MessageTable.isRead eq false }
        }
        
        val totalCount = query.count()
        val messages = query
            .orderBy(MessageTable.createdAt to SortOrder.DESC)
            .limit(size, (page * size).toLong())
            .map { it.expose() }
            
        MessageListResponse(
            data = messages,
            totalCount = totalCount,
            page = page,
            size = size,
            totalPages = (totalCount + size - 1) / size
        )
    }
    
    fun markAsRead(messageId: String, userId: String) = transaction(database) {
        val message = MessageEntity.findById(UUID.fromString(messageId))
            ?: throw Exception("æ¶ˆæ¯ä¸å­˜åœ¨")
            
        if (message.recipientId != userId) {
            throw Exception("æ— æƒé™è®¿é—®æ­¤æ¶ˆæ¯")
        }
        
        message.isRead = true
        message.updatedAt = Clock.System.now()
    }
}
```

#### 2. å­¦å‘˜æœåŠ¡æ‰©å±•

```kotlin
class StudentService(
    private val database: Database,
    private val userService: UserService
) {
    
    fun recharge(uuid: String, amount: Float) = transaction(database) {
        val student = StudentEntity.findById(UUID.fromString(uuid))
            ?: throw Exception("ç”¨æˆ·ä¸å­˜åœ¨")
            
        student.balance += amount
        
        // åˆ›å»ºå……å€¼è®°å½•
        RechargeEntity.new {
            this.userId = uuid
            this.amount = amount
            this.createdAt = Clock.System.now()
        }
        
        LOGGER.info("å……å€¼æˆåŠŸï¼Œç”¨æˆ· IDï¼š$uuidï¼Œé‡‘é¢ï¼š$amountï¼Œä½™é¢ï¼š${student.balance}")
    }
    
    fun getRechargeHistory(userId: String, page: Int, size: Int): Pair<List<RechargeRecord>, Long> = 
        transaction(database) {
            val query = RechargeEntity.find { RechargeTable.userId eq userId }
            val totalCount = query.count()
            
            val records = query
                .orderBy(RechargeTable.createdAt to SortOrder.DESC)
                .limit(size, ((page - 1) * size).toLong())
                .map { it.expose() }
                
            records to totalCount
        }
}
```

## æƒé™æ§åˆ¶ç³»ç»Ÿ

### è®¤è¯æœºåˆ¶

#### 1. Session è®¤è¯é…ç½®

```kotlin
// è®¤è¯é…ç½®
install(Authentication) {
    session<UserSession>("auth-session-all") {
        validate { session ->
            if (session.userId.isNotEmpty()) {
                UserIdPrincipal(session.userId)
            } else null
        }
        challenge {
            throw UnauthorizedException("æœªç™»å½•")
        }
    }
    
    session<UserSession>("auth-session-super-admin") {
        validate { session ->
            if (session.userId.isNotEmpty() && session.userRole == UserRole.SUPER_ADMIN) {
                UserIdPrincipal(session.userId)
            } else null
        }
        challenge {
            throw ForbiddenException("æƒé™ä¸è¶³")
        }
    }
}
```

#### 2. å¤šçº§æƒé™éªŒè¯

```kotlin
// æƒé™éªŒè¯ä¸­é—´ä»¶
fun Route.requireRole(vararg roles: UserRole, block: Route.() -> Unit) {
    intercept(ApplicationCallPipeline.Call) {
        val session = call.sessions.get<UserSession>()
        if (session == null || session.userRole !in roles) {
            throw ForbiddenException("æƒé™ä¸è¶³")
        }
    }
    block()
}

// ä½¿ç”¨ç¤ºä¾‹
route("/admin") {
    requireRole(UserRole.SUPER_ADMIN, UserRole.CAMPUS_ADMIN) {
        get("/users") { getUserList() }
    }
}
```

## å¼‚å¸¸å¤„ç†ç³»ç»Ÿ

### ç»Ÿä¸€å¼‚å¸¸å¤„ç†

```kotlin
// è‡ªå®šä¹‰å¼‚å¸¸ç±»
class UnauthorizedException(message: String) : Exception(message)
class ForbiddenException(message: String) : Exception(message)
class BadRequestException(message: String) : Exception(message)

// çŠ¶æ€é¡µé¢é…ç½®
install(StatusPages) {
    exception<UnauthorizedException> { call, cause ->
        call.respond(HttpStatusCode.Unauthorized, cause.message ?: "æœªæˆæƒ")
    }
    
    exception<ForbiddenException> { call, cause ->
        call.respond(HttpStatusCode.Forbidden, cause.message ?: "æƒé™ä¸è¶³")
    }
    
    exception<BadRequestException> { call, cause ->
        call.respond(HttpStatusCode.BadRequest, cause.message ?: "è¯·æ±‚å‚æ•°é”™è¯¯")
    }
    
    exception<Exception> { call, cause ->
        call.application.environment.log.error("Unhandled exception", cause)
        call.respond(HttpStatusCode.InternalServerError, "æœåŠ¡å™¨å†…éƒ¨é”™è¯¯")
    }
}
```

## æ€§èƒ½ä¼˜åŒ–

### 1. å‰ç«¯ä¼˜åŒ–

**ç»„ä»¶æ‡’åŠ è½½**:
```javascript
// è·¯ç”±æ‡’åŠ è½½
const routes = [
  {
    path: '/messages',
    component: () => import('@/views/MessagesView.vue')
  }
]

// ç»„ä»¶åŠ¨æ€å¯¼å…¥
const GlassCard = defineAsyncComponent(() => 
  import('@/components/GlassCard.vue')
)
```

**CSS ä¼˜åŒ–**:
```css
/* ç¡¬ä»¶åŠ é€Ÿ */
.glass-card {
  transform: translateZ(0);
  will-change: transform, opacity;
}

/* åŠ¨ç”»ä¼˜åŒ– */
@keyframes shimmer {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

.shimmer-effect::before {
  animation: shimmer 2s infinite;
  transform: translateZ(0);
}
```

### 2. åç«¯ä¼˜åŒ–

**æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–**:
```kotlin
// åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–
fun getMessages(userId: String, page: Int, size: Int) = transaction(database) {
    // ä½¿ç”¨ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢
    MessageEntity.find { 
        MessageTable.recipientId eq userId 
    }
    .orderBy(MessageTable.createdAt to SortOrder.DESC)
    .limit(size, (page * size).toLong())
    .map { it.expose() }
}

// æ‰¹é‡æ“ä½œä¼˜åŒ–
fun markAllAsRead(userId: String) = transaction(database) {
    MessageTable.update({ 
        MessageTable.recipientId eq userId and 
        MessageTable.isRead eq false 
    }) {
        it[isRead] = true
        it[updatedAt] = Clock.System.now()
    }
}
```

## å¼€å‘å·¥å…·ä¸è°ƒè¯•

### 1. å¼€å‘å·¥å…·é¡µé¢

```vue
<!-- DevToolsView.vue -->
<template>
  <div class="dev-tools">
    <!-- ç¯å¢ƒä¿¡æ¯ -->
    <GlassCardWithHeader title="ç¯å¢ƒä¿¡æ¯" icon="ğŸ”§">
      <StatusGrid :items="envItems" />
    </GlassCardWithHeader>
    
    <!-- APIæµ‹è¯• -->
    <GlassCardWithHeader title="APIæµ‹è¯•" icon="ğŸ”—">
      <div class="api-test">
        <el-button @click="testLogin">æµ‹è¯•ç™»å½•</el-button>
        <el-button @click="testMessages">æµ‹è¯•æ¶ˆæ¯</el-button>
        <el-button @click="testRecharge">æµ‹è¯•å……å€¼</el-button>
      </div>
    </GlassCardWithHeader>
    
    <!-- æƒé™æµ‹è¯• -->
    <GlassCardWithHeader title="æƒé™æµ‹è¯•" icon="ğŸ”">
      <StatusGrid :items="permissionItems" />
    </GlassCardWithHeader>
  </div>
</template>
```

### 2. è¯·æ±‚ç›‘æ§

```kotlin
// è¯·æ±‚æ—¥å¿—æ’ä»¶
install(CallLogging) {
    level = Level.INFO
    format { call ->
        val status = call.response.status()
        val httpMethod = call.request.httpMethod.value
        val userAgent = call.request.headers["User-Agent"]
        "Status: $status, HTTP method: $httpMethod, User agent: $userAgent"
    }
    
    filter { call ->
        call.request.path().startsWith("/api")
    }
}

// æ€§èƒ½ç›‘æ§
install(CallId) {
    header(HttpHeaders.XRequestId)
    generate { "req-${System.currentTimeMillis()}" }
}
```

## å®‰å…¨æ€§å¢å¼º

### 1. è¾“å…¥éªŒè¯

```kotlin
// æ•°æ®éªŒè¯
data class RechargeRequest(
    val amount: Float
) {
    init {
        require(amount > 0) { "å……å€¼é‡‘é¢å¿…é¡»å¤§äº0" }
        require(amount <= 10000) { "å•æ¬¡å……å€¼é‡‘é¢ä¸èƒ½è¶…è¿‡10000å…ƒ" }
    }
}

// ç”¨æˆ·è¾“å…¥è¿‡æ»¤
fun sanitizeInput(input: String): String {
    return input.trim()
        .replace(Regex("[<>\"'&]"), "")
        .take(255)
}
```

### 2. CORS é…ç½®

```kotlin
install(CORS) {
    allowMethod(HttpMethod.Options)
    allowMethod(HttpMethod.Put)
    allowMethod(HttpMethod.Delete)
    allowMethod(HttpMethod.Patch)
    allowHeader(HttpHeaders.Authorization)
    allowHeader(HttpHeaders.ContentType)
    allowCredentials = true
    
    // å¼€å‘ç¯å¢ƒ
    if (isDevelopment) {
        anyHost()
    } else {
        // ç”Ÿäº§ç¯å¢ƒæŒ‡å®šåŸŸå
        allowHost("ttts.com", schemes = listOf("https"))
    }
}
```

## API æ–‡æ¡£ç³»ç»Ÿ

### OpenAPI é›†æˆ

```kotlin
// OpenAPI æ’ä»¶é…ç½®
install(OpenAPI) {
    path = "/openapi"
    swaggerUI {
        version = SwaggerVersions.V4_15_5
    }
}

// API æ–‡æ¡£ç¤ºä¾‹
/**
 * @api {post} /wallet/recharge å­¦ç”Ÿå……å€¼é’±åŒ…
 * @apiGroup é’±åŒ…ç³»ç»Ÿ
 * @apiDescription å­¦ç”Ÿç”¨æˆ·è¿›è¡Œé’±åŒ…å……å€¼
 * 
 * @apiParam {Number} amount å……å€¼é‡‘é¢ï¼Œå¿…é¡»å¤§äº0ä¸”ä¸è¶…è¿‡10000
 * 
 * @apiSuccess {Number} balance å……å€¼åçš„è´¦æˆ·ä½™é¢
 * 
 * @apiError (400) BadRequest è¯·æ±‚å‚æ•°é”™è¯¯
 * @apiError (401) Unauthorized æœªè®¤è¯
 * @apiError (403) Forbidden æƒé™ä¸è¶³
 */
```

## éƒ¨ç½²é…ç½®

### Docker å®¹å™¨åŒ–

```yaml
# docker-compose.yml
version: '3.8'
services:
  mysql:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      MYSQL_DATABASE: ttts
    ports:
      - "3306:3306"
    volumes:
      - mysql_data:/var/lib/mysql
      - ./sql/init.sql:/docker-entrypoint-initdb.d/init.sql

  backend:
    build: 
      context: ./backend
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    depends_on:
      - mysql
    environment:
      DATABASE_URL: jdbc:mysql://mysql:3306/ttts
      DATABASE_USER: ${DATABASE_USER}
      DATABASE_PASSWORD: ${DATABASE_PASSWORD}

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "80:80"
    depends_on:
      - backend
    environment:
      VITE_API_BASE_URL: http://backend:8080
```

## ç›‘æ§ä¸æ—¥å¿—

### åº”ç”¨ç›‘æ§

```kotlin
// å¥åº·æ£€æŸ¥ç«¯ç‚¹
routing {
    get("/health") {
        call.respond(HttpStatusCode.OK, mapOf(
            "status" to "UP",
            "timestamp" to Clock.System.now(),
            "database" to checkDatabaseHealth(),
            "memory" to getMemoryUsage()
        ))
    }
}

// æ€§èƒ½æŒ‡æ ‡
fun getPerformanceMetrics() = mapOf(
    "activeConnections" to getActiveConnections(),
    "requestsPerSecond" to getRequestRate(),
    "averageResponseTime" to getAverageResponseTime(),
    "errorRate" to getErrorRate()
)
```

## æ€»ç»“

ç¬¬äºŒæ¬¡è¿­ä»£çš„æŠ€æœ¯å®ç°å–å¾—äº†é‡å¤§çªç ´ï¼š

### æ ¸å¿ƒæŠ€æœ¯æˆå°±

1. **è®¾è®¡ç³»ç»Ÿå»ºç«‹**: åˆ›å»ºäº†å®Œæ•´çš„Glassmorphismè®¾è®¡è¯­è¨€ï¼Œæä¾›äº†ç»Ÿä¸€çš„è§†è§‰è§„èŒƒ
2. **å‰åç«¯æ·±åº¦é›†æˆ**: å®ç°äº†å®Œæ•´çš„ä¸šåŠ¡æµç¨‹æ‰“é€šï¼Œå»ºç«‹äº†è§„èŒƒçš„APIä½“ç³»
3. **æƒé™ç®¡ç†å®Œå–„**: å»ºç«‹äº†å¤šå±‚çº§çš„æƒé™æ§åˆ¶ç³»ç»Ÿï¼Œç¡®ä¿äº†ç³»ç»Ÿå®‰å…¨æ€§
4. **å¼€å‘ä½“éªŒä¼˜åŒ–**: æä¾›äº†å®Œå–„çš„å¼€å‘å·¥å…·å’Œè°ƒè¯•ç¯å¢ƒï¼Œæå‡äº†å¼€å‘æ•ˆç‡

### æŠ€æœ¯äº®ç‚¹

- **ç°ä»£åŒ–è®¾è®¡**: Glassmorphismè®¾è®¡ç†å¿µçš„æˆåŠŸåº”ç”¨
- **ç»„ä»¶åŒ–æ¶æ„**: é«˜åº¦å¯å¤ç”¨çš„ç»„ä»¶ä½“ç³»
- **ç¯å¢ƒé…ç½®ç®¡ç†**: å®Œå–„çš„å¤šç¯å¢ƒé…ç½®ç³»ç»Ÿ
- **æ€§èƒ½ä¼˜åŒ–**: å‰åç«¯å…¨æ–¹ä½çš„æ€§èƒ½ä¼˜åŒ–
- **å®‰å…¨è®¾è®¡**: å¤šå±‚æ¬¡çš„å®‰å…¨é˜²æŠ¤æœºåˆ¶

### å¯æ‰©å±•æ€§

æœ¬æ¬¡è¿­ä»£å»ºç«‹çš„æŠ€æœ¯æ¶æ„å…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§ï¼Œä¸ºåç»­åŠŸèƒ½å¼€å‘æä¾›äº†åšå®çš„æŠ€æœ¯åŸºç¡€ã€‚ç³»ç»Ÿå·²ç»å…·å¤‡äº†ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²çš„åŸºæœ¬æ¡ä»¶ï¼Œå¯ä»¥æ”¯æŒå¤§è§„æ¨¡çš„ç”¨æˆ·è®¿é—®å’Œä¸šåŠ¡æ‰©å±•ã€‚
