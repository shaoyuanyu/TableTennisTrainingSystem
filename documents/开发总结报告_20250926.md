# 乒乓球培训管理系统 · 开发总结报告（截至 2025-09-26）

> 本报告基于仓库当前代码（前后端）、Git 记录，以及迭代01/迭代02文档生成，覆盖项目进展、技术栈、功能完成度、质量与风险、成员贡献与小结等。

## 项目概览

- 目标：为培训机构提供学员/教练/校区/课程/消息/充值等一体化信息化管理方案。
- 架构：前后端分离（Frontend: Vue 3 + Vite + Pinia + Element Plus + 自研设计系统；Backend: Kotlin + Ktor + Exposed + MySQL）。
- 形态：支持多角色权限、响应式UI、Docker 部署、OpenAPI 文档。

## 里程碑与已完成功能

- 第一次迭代（2025-09-07 完成）
  - 业务：基础用户体系（注册/登录）、初版权限框架、学员/教练基础页面与课表骨架。
  - 技术：前端工程化与组件化框架、后端项目脚手架、数据库初版模型、认证与会话、安全加密（BCrypt）。
- 第二次迭代（2025-09-13 完成）
  - 业务：站内消息系统、学生钱包充值与记录、校区管理、用户管理完善。
  - 设计：Glassmorphism 设计系统建立（42 个设计变量、15+ 组件族、完整响应式规范）。
  - 集成：前后端对接打通（认证/权限、消息、钱包、校区）、环境与配置管理、OpenAPI 文档。

## 代码结构要点（快照）

- Backend（Ktor）
  - 插件：`plugins/`（Database、Serialization、Authentication、Sessions、CORS、StatusPages、Monitoring）。
  - 领域路由：`routes/`（User、Message、Wallet、Campus、Coach、Course、Competition、Admin、MutualSelection）。
  - 业务与数据：`persistence/**`（Service + Exposed 表/实体；user、student、coach、campus、message、recharge、course、competition、mutual_selection、table）。
  - DTO：`dto/**` 覆盖用户、消息、充值、课程、比赛、校区等。
  - 配置与文档：`src/main/resources`（`application.conf`、`logback.xml`、`openapi/documentation.yaml`）。
- Frontend（Vue 3）
  - 状态与路由：`stores/**`（user、messages、system）、`router/index.js`（路由与守卫）。
  - 业务视图：学生（预约/课表/充值/互选/比赛）、教练（审批/课表/反馈）、校区（学生/教练/场地/日志/赛事）、管理员（数据导出、系统状态）。
  - 设计系统：`styles/design-system.css`、`styles/variables.scss`、`components/cards/buttons/form/feedback/...`、`DesignSystemTestView.vue`。
  - 工具：`utils/**`（api、auth、permissions、errorHandler、scheduleSyncExamples）。

## 技术栈与工程实践

- 前端：Vue 3、Pinia、Vue Router、Element Plus、Vite、Vitest、ESLint + Prettier、自研设计系统（Glassmorphism）。
- 后端：Kotlin、Ktor、Exposed ORM、MySQL、HikariCP、BCrypt、OpenAPI、Logback、Docker。
- 规范：分支策略（master/dev/feature/*）、提交信息规范、权限与异常统一处理、环境配置分离（.env）。

## Git 统计与贡献概览（到当前仓库）

- 提交次数（git shortlog）：
  - YSY: 151，Yewargg: 50，yanfeng: 34，Code200: 12，YangLiangwei: 10，simiao gao: 7，Meijianxve: 3，gawesime: 1。
- 依据成员映射（未指明的用户名记入“余绍缘”）：
  - 余绍缘（YSY、Code200，含未指明：YangLiangwei/Meijianxve/gawesime/...）：合计 184 次提交。
  - 王邺（YeWargg/Yewargg）：50 次提交。
  - 杨元枭（yanfeng）：34 次提交。
- 变更行数（git log --numstat，含新增+删除；含文档/资源大文件，值偏大；同时给出前后端细分便于客观对比）：
  - 全仓：+868,615 / -809,641 = 1,678,256。
  - Frontend：+81,302 / -36,598 = 117,900。
  - Backend：+17,043 / -7,375 = 24,418。
- 按作者（模块细分，单位=变更行，包含新增+删除）：
  - 余绍缘（合并 YSY/Code200 及未指明账号）：
    - 总计 ≈ 900,074；Frontend ≈ 108,099；Backend ≈ 19,955。
  - 王邺（Yewargg）：总计 8,145；Frontend 4,007；Backend 4,138（前后端较均衡）。
  - 杨元枭（yanfeng）：总计 770,037；Frontend 5,794；Backend 325（大量文档/静态内容变更显著拉高总量）。

> 说明：为避免文档/静态资源批量变动造成“虚高”，前后端子目录统计更能反映编码投入结构。

## 质量、稳定性与运维

- 质量保障：
  - 前端 ESLint/Prettier、一致的设计 token、可复用组件库、路由与权限守卫、错误处理统一化。
  - 后端 统一异常（Unauthorized/Forbidden/BadRequest 等）、会话与权限拦截、中间件分层、OpenAPI 文档。
- 安全性：
  - 密码加密（BCrypt）、会话安全、CORS 控制、输入校验、SQL 注入防护（ORM）。
- 运行与监控：
  - Logback 日志、CallLogging/CallId、健康检查端点（health）。
- 交付与部署：
  - Docker Compose，分环境配置（前端 VITE_API_BASE_URL，后端数据库连接等）。

## 风险与问题

- 测试覆盖率偏低：需补齐单元/集成/E2E 测试，保障核心业务（消息/充值/预约/权限）。
- 前后端数据契约演进：需在 OpenAPI/DTO 层面保持稳定与版本化，降低联调成本。
- 复杂权限与多角色：继续打磨细粒度权限与数据访问控制（尤其是管理后台与跨校区）。
- 性能与容量：分页与索引优化、消息/记录批量操作与归档、静态资源与构建优化。

## 下一步计划（建议）

- 业务：课程预约完善、教练审核、支付对接、评价体系、数据统计面板。
- 工程：
  - 测试体系：Vitest + Vue Test Utils、JUnit/Ktor 测试；关键路径 E2E；覆盖率指标化。
  - 性能：前端代码分割与懒加载、后端分页/索引/缓存、资源压缩。
  - 体验：PWA、移动端交互优化、国际化、可访问性改进。
  - 文档：OpenAPI 对齐、组件与设计系统文档补全、运维与排障指引。

## 成员开发小结（按用户映射汇总）

> 用户名与真名映射：
> - Code200 / YSY / 未指明（如：YangLiangwei、Meijianxve、gawesime 等）→ 余绍缘
> - YeWargg/Yewargg → 王邺
> - yanfeng → 杨元枭

### 余绍缘

- 角色与范围：全栈/架构促进者，覆盖设计系统、前端核心页面与组件，及后端多个领域路由与服务。
- 主要产出（节选）：
  - 前端：设计系统（variables/design-system.css、GlassCard/ModernButton/TagBadge/StatusGrid 等）、路由与权限、消息中心、学生侧预约/课表/充值、校区/管理员页面等。
  - 后端：认证/会话/异常、User/Message/Wallet/Campus/Coach/Course/Competition/Admin/MutualSelection 等路由与 Service、OpenAPI 文档与基础设施插件。
- 贡献数据：
  - 提交：≈ 184 次（含未指明账户合并）。
  - 变更行：总计 ≈ 900,074；Frontend ≈ 108,099；Backend ≈ 19,955。
- 亮点：
  - 自研设计系统沉淀，统一视觉与交互、显著提升复用与效率。
  - 前后端架构完善与打通，业务模块覆盖广、基础设施健全。
- 建议：
  - 推进测试基线与监控指标，完善关键路径自动化与回归策略。
  - 后端接口版本化与契约治理，减少联调与变更影响面。

### 王邺

- 角色与范围：全栈开发，前后端均衡投入。
- 主要产出（节选）：
  - 前端：消息/校区/钱包等业务对接与页面完善、权限守卫/状态管理协作。
  - 后端：消息、钱包、校区、用户管理等接口实现与参数校验、分页与记录查询。
- 贡献数据：
  - 提交：50 次。
  - 变更行：总计 8,145；Frontend 4,007；Backend 4,138（均衡）。
- 亮点：
  - 以业务交付为导向的前后端协同，接口与页面闭环推进。
- 建议：
  - 深化后端异常与权限颗粒度，前端补齐空态/加载/错误统一模式与用例。

### 杨元枭

- 角色与范围：前端与文档侧贡献，参与页面与说明文档完善。
- 主要产出（节选）：
  - 文档：需求/技术/工作总结体系化整理，降低沟通成本。
  - 前端：部分页面与组件增强、路由/状态协作、设计系统使用落地。
- 贡献数据：
  - 提交：34 次。
  - 变更行：总计 770,037；Frontend 5,794；Backend 325（总量受文档/静态内容变动影响较大）。
- 亮点：
  - 文档体系与可读性提升显著，助力团队对齐与复盘。
- 建议：
  - 结合用例完善前端单测，补充复杂表单与权限场景的交互测试。

## 小结

- 两次迭代完成核心业务从“可运行”到“可交付”的关键跃迁，形成统一的设计语言、较完善的权限与消息/充值/校区模块、以及可部署的工程基线。
- 短板主要在测试与契约治理、以及部分复杂业务（预约/支付/评价）的进一步完善；建议以“测试+契约+性能”三线并行，支撑第三次迭代与灰度试用。

---

附：如需查看具体文件与模块，请参考：

- 后端：`backend/src/main/kotlin/io/github/shaoyuanyu/ttts/**`、`backend/src/main/resources/**`
- 前端：`frontend/src/**`
- 文档：`documents/迭代01_20250907/`、`documents/迭代02_20250913/`
